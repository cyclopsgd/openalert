# ====================================
# OpenAlert Production Environment Configuration
# ====================================
#
# IMPORTANT: This is a template file for production deployments.
#
# Instructions:
# 1. Copy this file to .env.production
# 2. Update all placeholder values with actual production values
# 3. NEVER commit .env.production to version control
# 4. Use secure secret management (e.g., Kubernetes Secrets, HashiCorp Vault)
#
# Security Best Practices:
# - Generate strong random secrets using: openssl rand -base64 32
# - Use different secrets for each environment
# - Rotate secrets regularly
# - Never expose secrets in logs or error messages
# - Use environment-specific credentials

# ====================================
# Environment
# ====================================
NODE_ENV=production
PORT=3001

# ====================================
# Application URLs
# ====================================
# Update with your actual domain
API_URL=https://your-domain.com/api
FRONTEND_URL=https://your-domain.com
WS_URL=wss://your-domain.com

# CORS Configuration
ALLOWED_ORIGINS=https://your-domain.com,https://www.your-domain.com

# ====================================
# Database Configuration (PostgreSQL)
# ====================================
# Production database credentials
DATABASE_URL=postgresql://openalert:CHANGE_ME_STRONG_PASSWORD@postgres:5432/openalert

# Individual components (for docker-compose)
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=openalert
POSTGRES_USER=openalert
POSTGRES_PASSWORD=CHANGE_ME_STRONG_PASSWORD

# Connection pool settings
DB_POOL_MIN=10
DB_POOL_MAX=50

# ====================================
# Redis Configuration
# ====================================
REDIS_URL=redis://redis:6379
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=  # Set if using Redis password

# Cache settings
CACHE_ENABLED=true
REDIS_CACHE_TTL_DEFAULT=300  # 5 minutes in production

# ====================================
# Security & Authentication
# ====================================
# CRITICAL: Generate new secrets for production!
# Generate using: openssl rand -base64 32

# JWT Secret (MUST be changed)
JWT_SECRET=CHANGE_ME_GENERATE_RANDOM_SECRET_MIN_32_CHARS

# JWT Configuration
JWT_EXPIRATION=24h
JWT_REFRESH_EXPIRATION=7d

# Cookie Secret (MUST be changed)
COOKIE_SECRET=CHANGE_ME_GENERATE_RANDOM_SECRET_MIN_32_CHARS

# Session Configuration
SESSION_SECRET=CHANGE_ME_GENERATE_RANDOM_SECRET_MIN_32_CHARS
SESSION_MAX_AGE=86400000  # 24 hours

# ====================================
# Azure AD / Entra ID (SSO)
# ====================================
# Get from Azure Portal > App Registrations
AZURE_AD_TENANT_ID=your-tenant-id
AZURE_AD_CLIENT_ID=your-client-id
AZURE_AD_CLIENT_SECRET=your-client-secret
AZURE_AD_REDIRECT_URI=https://your-domain.com/api/auth/callback

# ====================================
# Email Notifications (SendGrid)
# ====================================
# Get API key from: https://app.sendgrid.com/settings/api_keys
SENDGRID_API_KEY=SG.your-sendgrid-api-key
SENDGRID_FROM_EMAIL=alerts@your-domain.com
SENDGRID_FROM_NAME=OpenAlert

# Email Templates
EMAIL_TEMPLATE_INCIDENT_CREATED=d-xxxxx
EMAIL_TEMPLATE_INCIDENT_ACKNOWLEDGED=d-xxxxx
EMAIL_TEMPLATE_INCIDENT_RESOLVED=d-xxxxx

# ====================================
# SMS & Voice (Twilio) - Optional
# ====================================
TWILIO_ACCOUNT_SID=your-twilio-account-sid
TWILIO_AUTH_TOKEN=your-twilio-auth-token
TWILIO_PHONE_NUMBER=+1234567890
TWILIO_VERIFY_SID=your-verify-service-sid

# ====================================
# Push Notifications (Firebase) - Optional
# ====================================
FIREBASE_PROJECT_ID=your-project-id
FIREBASE_PRIVATE_KEY=your-private-key-in-base64
FIREBASE_CLIENT_EMAIL=firebase-adminsdk@your-project.iam.gserviceaccount.com

# ====================================
# Slack Integration - Optional
# ====================================
SLACK_BOT_TOKEN=xoxb-your-slack-bot-token
SLACK_SIGNING_SECRET=your-slack-signing-secret
SLACK_APP_ID=your-app-id

# ====================================
# Microsoft Teams Integration - Optional
# ====================================
TEAMS_WEBHOOK_URL=https://outlook.office.com/webhook/...
TEAMS_APP_ID=your-teams-app-id
TEAMS_APP_PASSWORD=your-teams-app-password

# ====================================
# PagerDuty Integration - Optional
# ====================================
PAGERDUTY_API_KEY=your-pagerduty-api-key
PAGERDUTY_INTEGRATION_KEY=your-integration-key

# ====================================
# Monitoring & Observability
# ====================================
# Logging
LOG_LEVEL=info
LOG_FORMAT=json
ENABLE_MORGAN_LOGGING=true

# Metrics
ENABLE_METRICS=true
METRICS_PORT=9090

# Tracing (Optional - Jaeger/OpenTelemetry)
ENABLE_TRACING=false
JAEGER_AGENT_HOST=localhost
JAEGER_AGENT_PORT=6831

# Sentry (Error Tracking) - Optional
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# ====================================
# Rate Limiting
# ====================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_WINDOW_MS=60000  # 1 minute

# Webhook specific limits
WEBHOOK_RATE_LIMIT_MAX=1000
WEBHOOK_RATE_LIMIT_WINDOW_MS=60000

# ====================================
# Queue Configuration (BullMQ)
# ====================================
QUEUE_CONCURRENCY=10
QUEUE_MAX_RETRIES=3
QUEUE_BACKOFF_DELAY=5000

# ====================================
# File Upload
# ====================================
MAX_FILE_SIZE=10485760  # 10MB
UPLOAD_DEST=./uploads

# ====================================
# Feature Flags
# ====================================
ENABLE_REGISTRATION=false  # Disable public registration in production
ENABLE_SSO=true
ENABLE_2FA=true
ENABLE_API_DOCS=false  # Disable Swagger in production for security

# ====================================
# Backup Configuration
# ====================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_DIR=/backups

# S3 Backup (Optional)
AWS_ACCESS_KEY_ID=your-aws-access-key
AWS_SECRET_ACCESS_KEY=your-aws-secret-key
AWS_BACKUP_BUCKET=your-backup-bucket
AWS_REGION=us-east-1

# ====================================
# Data Directories (Docker Compose)
# ====================================
DATA_DIR=./data
LOG_DIR=./logs
BACKUP_DIR=./backups

# ====================================
# Version & Build Info
# ====================================
VERSION=latest
BUILD_DATE=2024-01-01
GIT_COMMIT=abc123

# ====================================
# Health Check Configuration
# ====================================
HEALTH_CHECK_TIMEOUT=5000
HEALTH_CHECK_INTERVAL=30000

# ====================================
# Timezone
# ====================================
TZ=UTC
